<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Click Rewards</title>
<style>
body{font-family:sans-serif;margin:0;padding:0;background:#f9f9f9;}
header{background:#222;color:#fff;padding:10px;text-align:center;}
section{padding:15px;}
.card{background:#fff;margin-bottom:10px;padding:10px;border-radius:8px;box-shadow:0 0 5px rgba(0,0,0,0.1);}
button{background:#007bff;color:white;padding:8px 12px;border:none;border-radius:6px;margin-top:5px;cursor:pointer;}
input,select{padding:8px;width:95%;margin:5px 0;border:1px solid #ccc;border-radius:5px;}
.hidden{display:none;}
</style>
</head>
<body>

<header>
  <h2>Click Rewards</h2>
</header>

<section id="registerSection">
  <div class="card">
    <h3>Register</h3>
    <input id="regName" placeholder="Enter your name">
    <input id="regWallet" placeholder="Enter Binance ID / POL Address">
    <button onclick="doRegister()">Register</button>
  </div>
</section>

<section id="appSection" class="hidden">
  <div class="card">
    <h3>Welcome, <span id="userName"></span></h3>
    <p><b>Your Wallet:</b> <span id="userWallet"></span></p>
    <p><b>Balance:</b> $<span id="userBalance">0.00</span></p>
    <p><b>Your Referral Link:</b><br><input id="refLink" readonly></p>
    <button onclick="logout()">Logout</button>
  </div>

  <div class="card">
    <h3>Earn Tasks</h3>
    <button onclick="completeTask()">✅ Complete a Task (+$0.01)</button>
  </div>

  <div class="card">
    <h3>Withdraw</h3>
    <input type="number" id="withdrawAmount" placeholder="Enter Amount">
    <button onclick="withdraw()">Request Withdraw</button>
    <p><b>History:</b></p>
    <ul id="withdrawHistory"></ul>
  </div>
</section>

<script>
let users = JSON.parse(localStorage.getItem("users")||"{}");
let currentUserId = localStorage.getItem("currentUserId")||null;

// Telegram Bot Details
const BOT_USERNAME = "@Adsclickpaybot"; 
const BOT_TOKEN = "YOUR_BOT_TOKEN"; // Add your bot token here
const CHAT_ID = "YOUR_ADMIN_CHAT_ID"; // Add admin chat id here

function uid(len){return Math.random().toString(36).substr(2,len);}
function saveUsers(){localStorage.setItem("users", JSON.stringify(users));}

function doRegister(){
  const name = document.getElementById("regName").value.trim();
  const wallet = document.getElementById("regWallet").value.trim();
  if(!name || !wallet){alert("Please fill all fields"); return;}
  const id = "u_"+uid(8);
  const invite = "PT-"+Math.floor(1000+Math.random()*9000);
  users[id] = {id, name, wallet, balance:0, inviteCode:invite, withdraws:[]};

  // Referral logic
  const params = new URLSearchParams(location.search);
  const ref = params.get("ref");
  if(ref && users[ref]){
    users[ref].balance = (users[ref].balance || 0) + 0.01;
    users[ref].withdraws.unshift(`Referral bonus from ${name} (+$0.01) — ${new Date().toLocaleString()}`);
  }

  currentUserId = id;
  saveUsers();
  localStorage.setItem("currentUserId", currentUserId);
  refreshUI();
}

function refreshUI(){
  if(!currentUserId){document.getElementById("registerSection").classList.remove("hidden");
  document.getElementById("appSection").classList.add("hidden"); return;}

  document.getElementById("registerSection").classList.add("hidden");
  document.getElementById("appSection").classList.remove("hidden");

  const user = users[currentUserId];
  document.getElementById("userName").textContent = user.name;
  document.getElementById("userWallet").textContent = user.wallet;
  document.getElementById("userBalance").textContent = user.balance.toFixed(2);
  document.getElementById("refLink").value = `${location.origin}${location.pathname}?ref=${currentUserId}`;
  
  const list = document.getElementById("withdrawHistory");
  list.innerHTML="";
  (user.withdraws||[]).forEach(w=>{const li=document.createElement("li");li.textContent=w;list.appendChild(li);});
}

function completeTask(){
  const user = users[currentUserId];
  user.balance += 0.01;
  user.withdraws.unshift(`Task Completed (+$0.01) — ${new Date().toLocaleString()}`);
  saveUsers();
  refreshUI();
}

function withdraw(){
  const amount = parseFloat(document.getElementById("withdrawAmount").value);
  const user = users[currentUserId];
  if(!amount || amount<=0){alert("Enter valid amount");return;}
  if(user.balance < amount){alert("Insufficient balance");return;}

  user.balance -= amount;
  user.withdraws.unshift(`Withdraw Request: $${amount} — ${new Date().toLocaleString()}`);
  saveUsers();
  refreshUI();

  // Telegram Notification
  fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body: JSON.stringify({
      chat_id: CHAT_ID,
      text: `💸 *Withdraw Request*\n👤 User: ${user.name}\n🆔 ID: ${user.id}\n💰 Amount: $${amount}\n🏦 Wallet: ${user.wallet}\n\nBot: ${BOT_USERNAME}`,
      parse_mode: "Markdown"
    })
  });
}

function logout(){
  localStorage.removeItem("currentUserId");
  currentUserId = null;
  refreshUI();
}

refreshUI();
</script>
</body>
</html>
